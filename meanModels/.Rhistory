vcWI$cond$band_number$`(Intercept)`)
varcomps
length(varcomps)
length(vcCC)
length(vcCC$cond$band_number$`(Intercept)`)
> length(vcCI$cond$band_number$`(Intercept)`)
length(vcCI$cond$band_number$`(Intercept)`)
length(vcWC$cond$band_number$`(Intercept)`)
length(vcWI$cond$band_number$`(Intercept)`)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`))
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcomps)
head(btwbird)
hist(varcomps)
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
summary(modbtw)
anova(modbtw)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_point()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_point()+
facet_wrap(~treatment, dpi)
View(ti.pi)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_point()+
facet_wrap(~treatment + dpi)
varcompsABS <- abs(varcomps)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) # should be normalish because that's where they were drawn from
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS)
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
modbtw <- glm(varcomp ~ temp*treatment, data = btwbird,
family = Gamma())
hist(residuals(modbtw))
summary(modbtw)
anova(modbtw) #no difference in btw bird variability
emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_point()+
facet_wrap(~treatment)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
varcomps
varcompsABS
options(scipen = 100, digits = 4)
varcompsABS
varcomps
summary(modbtw)
summary(modcc)
modcc <- glmmTMB(elisa_od ~ 0 + (1|band_number), data = coldcon,
family = Gamma())
modwc <- glmmTMB(elisa_od ~ 0 + (1|band_number), data = warmcon,
family = Gamma())
modci <- glmmTMB(elisa_od ~ 0 + (1|band_number), data = coldinf,
family = Gamma())
modwi <- glmmTMB(elisa_od ~ 0 + (1|band_number), data = warminf,
family = Gamma())
summary(modcc)
vcCC<- ranef(modcc)
vcWC<- ranef(modwc)
vcCI<- ranef(modci)
vcWI<- ranef(modwi)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
varcompsABS <- abs(varcomps)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- glm(varcomp ~ temp*treatment, data = btwbird,
family = Gamma())
hist(residuals(modbtw))
summary(modbtw)
anova(modbtw) #no difference in btw bird variability
emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
modcc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldcon,
family = Gamma())
modwc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warmcon,
family = Gamma())
modci <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldinf,
family = Gamma())
modwi <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warminf,
family = Gamma())
vcCC<- ranef(modcc)
vcWC<- ranef(modwc)
vcCI<- ranef(modci)
vcWI<- ranef(modwi)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
varcompsABS <- abs(varcomps)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- glm(varcomp ~ temp*treatment, data = btwbird,
family = Gamma())
hist(residuals(modbtw))
summary(modbtw)
anova(modbtw) #no difference in btw bird variability
summary(modbtw)
summary(modci)
summary(modwc)
summary(modci)
summary(modwi)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcomps)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- glm(varcomp ~ temp*treatment, data = btwbird,
family = Gamma())
hist(residuals(modbtw))
summary(modbtw)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- glm(varcomp ~ temp*treatment, data = btwbird,
family = Gamma())
hist(residuals(modbtw))
summary(modbtw)
anova(modbtw) #no difference in btw bird variability
anova(modbtw) #no difference in btw bird variability
car::Anova(modbtw)
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
summary(modbtw)
emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
cld(means)
plot(residuals(modbtw), predict(modbtw))
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
cld(means)
summary(modcc)
cld(means)
summary(modwi)
summary(modwc)
View(warmcon)
# Remove birds that do not have both observations?
table(ti.pi$band_number)
# Remove birds that do not have both observations?
ti.pi <- ti.pi %>% na.omit(elisa_od)
table(ti.pi$band_number)
subset(ti.pi,band_number $in$ c(2632, 2842, 2846, 2847,
subset(ti.pi,band_number $in$ c(2632, 2842, 2846, 2847,
subset(ti.pi,band_number %in% c(2632, 2842, 2846, 2847,
2869, 2926))
subset(ti.pi, !(band_number %in% c(2632, 2842, 2846, 2847,
2869, 2926)))
ti.pi <- subset(ti.pi, !(band_number %in% c(2632, 2842, 2846, 2847,
2869, 2926)))
coldcon <- ti.pi %>% filter(temp == "Cold" & treatment == "Control")
warmcon <- ti.pi %>% filter(temp == "Warm" & treatment == "Control")
coldinf <- ti.pi %>% filter(temp == "Cold" & treatment == "Infected")
warminf <- ti.pi %>% filter(temp == "Warm" & treatment == "Infected")
modcc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldcon,
family = Gamma())
modwc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warmcon,
family = Gamma())
modci <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldinf,
family = Gamma())
modwi <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warminf,
family = Gamma())
vcCC<- ranef(modcc)
vcWC<- ranef(modwc)
vcCI<- ranef(modci)
vcWI<- ranef(modwi)
length(vcCC)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
vcCC
length(vcCC$cond$band_number)
length(vcCC$cond$band_number$`(Intercept)`)
length(vcCI$cond$band_number$`(Intercept)`)
length(vcWC$cond$band_number$`(Intercept)`)
length(vcWI$cond$band_number$`(Intercept)`)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 18)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 6), rep("Infected", 12)),
varcomp = varcompsABS)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
varcompsABS <- abs(varcomps)
length(varcomps)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 18)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 6), rep("Infected", 12)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
plot(residuals(modbtw), predict(modbtw))
summary(modbtw)
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
library(emmeans)
library(multcomp)
library(ggplot2)
library(tidyverse)
library(lme4)
library(glmmTMB)
library(effects)
#library(AICcmodavg)
library(DHARMa)
library(optimx)
source("dataCleaning_antibody.R")
unique(ti.pi$dpi)
ti.pi$dpi <- as.factor(ti.pi$dpi)
ti.pi$band_number <- as.factor(ti.pi$band_number)
# Simplify data set so pivot_wider works
ti.pi <- ti.pi %>% select(dpi, band_number, treatment, temp,
sex, elisa_od)
wibird <- ti.pi %>% pivot_wider(names_from = dpi,
names_glue = "{.value}_{dpi}",
values_from = elisa_od)
wibird <- wibird %>% mutate(elisa_diff = abs(elisa_od_9 - elisa_od_28))
library(CValternatives)
pvs <- c()
for (i in 1:nrow(wibird)){
vec <- c(wibird$elisa_od_9[i], wibird$elisa_od_28[i])
pvs[i] <- PV(vec)
}
wibird$pv <- pvs
ggplot(wibird, aes(x = treatment, y = pv))+
geom_point()+
facet_wrap(~temp)
ggplot(wibird, aes(x = treatment, y = elisa_diff))+
geom_point()+
facet_wrap(~temp)
hist(wibird$elisa_diff)
hist(wibird$pv) #looks pretty skewed - gamma regression probably ideal
wibird$pv_plus <- wibird$pv + 0.0001
mod <- glm(pv_plus ~ temp*treatment, data = wibird,
family = Gamma())
summary(mod)
simulateResiduals(mod, plot = T) #Assumptions check out
car::Anova(mod, type = "III")
# Remove birds that do not have both observations?
ti.pi <- ti.pi %>% na.omit(elisa_od)
coldcon <- ti.pi %>% filter(temp == "Cold" & treatment == "Control")
warmcon <- ti.pi %>% filter(temp == "Warm" & treatment == "Control")
coldinf <- ti.pi %>% filter(temp == "Cold" & treatment == "Infected")
warminf <- ti.pi %>% filter(temp == "Warm" & treatment == "Infected")
modcc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldcon,
family = Gamma())
modwc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warmcon,
family = Gamma())
modci <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldinf,
family = Gamma())
modwi <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warminf,
family = Gamma())
vcCC<- ranef(modcc)
vcWC<- ranef(modwc)
vcCI<- ranef(modci)
vcWI<- ranef(modwi)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
varcompsABS <- abs(varcomps)
length(vcCC$cond$band_number$`(Intercept)`)
length(vcCI$cond$band_number$`(Intercept)`)
length(vcWC$cond$band_number$`(Intercept)`)
length(vcWI$cond$band_number$`(Intercept)`)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
plot(residuals(modbtw), predict(modbtw))
summary(modbtw)
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
plot(residuals(modbtw), predict(modbtw))
summary(modbtw)
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(ti.pi, aes(x = temp, y = elisa_od))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
modcc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldcon,
family = gaussian())
modwc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warmcon,
family = gaussian())
modci <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldinf,
family = gaussian())
modwi <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warminf,
family = gaussian())
vcCC<- ranef(modcc)
vcWC<- ranef(modwc)
vcCI<- ranef(modci)
vcWI<- ranef(modwi)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
varcompsABS <- abs(varcomps)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
plot(residuals(modbtw), predict(modbtw))
summary(modbtw)
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
modcc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldcon,
family = Gamma(link = "log"))
modwc <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warmcon,
family = Gamma(link = "log"))
modci <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = coldinf,
family = Gamma(link = "log"))
modwi <- glmmTMB(elisa_od ~ 1 + (1|band_number), data = warminf,
family = Gamma(link = "log"))
vcCC<- ranef(modcc)
vcWC<- ranef(modwc)
vcCI<- ranef(modci)
vcWI<- ranef(modwi)
varcomps <- c(vcCC$cond$band_number$`(Intercept)`,
vcCI$cond$band_number$`(Intercept)`,
vcWC$cond$band_number$`(Intercept)`,
vcWI$cond$band_number$`(Intercept)`)
varcompsABS <- abs(varcomps)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcompsABS)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
plot(residuals(modbtw), predict(modbtw))
summary(modbtw)
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
ggplot(means, aes(x = temp, y = emmean))+
geom_jitter()+
facet_wrap(~treatment)
btwbird
ggplot(btwbird, aes(x = temp, y = varcomp))+
geom_jitter()+
facet_wrap(~treatment)
btwbird <- data.frame(temp = c(rep("Cold",20), rep("Warm", 24)),
treatment = c(rep("Control", 6), rep("Infected", 14),
rep("Control", 10), rep("Infected", 14)),
varcomp = varcomps)
head(btwbird)
hist(varcomps) # should be normalish because that's where they were drawn from
hist(varcompsABS) #now all positive - use gamma?
modbtw <- lm(varcomp ~ temp*treatment, data = btwbird)
hist(residuals(modbtw))
plot(residuals(modbtw), predict(modbtw))
summary(modbtw)
means <- emmeans(modbtw, pairwise ~ temp:treatment, adjust = "tukey",
type ="response")
cld(means)
meancc <- mean(coldcon$elisa_od)
meanci <- mean(coldinf$elisa_od)
meanwc <- mean(warmcon$elisa_od)
meanwi <- mean(warminf$elisa_od)
coldcon$res <- abs(coldcon$elisa_od - meancc)
coldinf$res <- abs(coldinf$elisa_od - meanci)
warmcon$res <- abs(warmcon$elisa_od - meanwc)
warminf$res <- abs(warminf$elisa_od - meanwi)
coldcon
dat <- cbind(coldcon, coldinf, warmcon, warminf)
dat
dat <- rbind(coldcon, coldinf, warmcon, warminf)
dat
mod <- lmer(res ~ temp*treatment*dpi, data = dat)
mod <- lm(res ~ temp*treatment*dpi, data = dat)
hist(residuals(mod))
plot(residuals(mod), predict(mod))
mod <- glm(res ~ temp*treatment*dpi, data = dat,
family = Gamma())
hist(residuals(mod))
plot(residuals(mod), predict(mod))
anova(mod)
Anova(mod)
car::Anova(mod, type = "II")
car::Anova(mod, type = "III")
stepAIC(mod)
modstep <- stepAIC(mod)
car::Anova(modstep, type = "III")
ggplot(dat, aes(x = temp, y = res))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
ggplot(dat, aes(x = elisa_od, y = res))+
geom_jitter(width = 0.1)
summary(lm(elisa_od ~ res, data = dat))
ggplot(dat, aes(x = elisa_od, y = res))+
geom_point()
ggplot(dat, aes(x = temp, y = res))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
car::Anova(modstep, type = "III")
emmeans(modstep, pairwise ~ temp:dpi, adjust = "tukey",
type = "response")
car::Anova(modstep, type = "III")
emmeans(modstep, pairwise ~ dpi, adjust = "tukey",
type = "response")
emmeans(modstep, pairwise ~ dpi, adjust = "tukey",
type = "response")
car::Anova(modstep, type = "III")
emmeans(modstep, pairwise ~ treatment, adjust = "tukey",
type = "response")
ggplot(dat, aes(x = dpi, y = res, color = temp))+
geom_jitter(width = 0.1)+
facet_wrap(~treatment)
