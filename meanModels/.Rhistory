library(emmeans)
library(multcomp)
library(ggplot2)
library(tidyverse)
library(lme4)
library(glmmTMB)
library(effects)
library(AICcmodavg)
library(DHARMa)
library(optimx)
source("dataCleaning_eyeScore.R")
ti.mg.mod$band_number <- as.factor(ti.mg.mod$band_number)
lm1 <- glmer(tes ~ temp*dpi + (1|band_number),
data=ti.mg.mod,
family = poisson,
control = glmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B')))
AF1 <- allFit(lm1, verbose=F)
AF1_lliks <- sort(sapply(AF1,logLik))
bind_rows(AF1_lliks) %>%
remove_rownames(.) %>%
mutate(model = c("NB Mixed Effects Model")) %>%
select(model, everything()) %>%
group_by(model) %>%
gather(., Optimizer, llik, 2:ncol(.)) %>%
ggplot(.,aes(Optimizer, llik)) + geom_point() +
facet_wrap(~model) + coord_flip() +
ylab("Log-Likelihood") +
labs(title = "The Log-Likelihoods of Seven Different Optimizers in Our Model")
simulateResiduals(lm1, plot = T)
car::Anova(lm1, type = "III")
lm1 <- glmer(tes ~ temp+dpi + (1|band_number),
data=ti.mg.mod,
family = poisson,
control = glmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B')))
AF1 <- allFit(lm1, verbose=F)
AF1_lliks <- sort(sapply(AF1,logLik))
bind_rows(AF1_lliks) %>%
remove_rownames(.) %>%
mutate(model = c("NB Mixed Effects Model")) %>%
select(model, everything()) %>%
group_by(model) %>%
gather(., Optimizer, llik, 2:ncol(.)) %>%
ggplot(.,aes(Optimizer, llik)) + geom_point() +
facet_wrap(~model) + coord_flip() +
ylab("Log-Likelihood") +
labs(title = "The Log-Likelihoods of Seven Different Optimizers in Our Model")
simulateResiduals(lm1, plot = T)
car::Anova(lm1, type = "III")
summary(lm1)
means <- cld(emmeans(lm1, pairwise ~ dpi*temp, adjust = "tukey", type = "response"))
means <- cld(emmeans(lm1, pairwise ~ dpi, adjust = "tukey", type = "response"))
ggplot(means, aes(x = dpi, y = rate, color = temp))+
geom_jitter(data = ti.mg, aes(x = dpi, y = tes),
width = 0.1, alpha = 0.5)+
geom_line(aes(group = temp), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
ggplot(means, aes(x = dpi, y = rate))+
geom_jitter(data = ti.mg, aes(x = dpi, y = tes, color = temp),
width = 0.1, alpha = 0.5)+
geom_line(aes(group = 1), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
lm1 <- glmer(tes ~ temp*dpi + (1|band_number),
data=ti.mg.mod,
family = poisson,
control = glmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B')))
AF1 <- allFit(lm1, verbose=F)
AF1_lliks <- sort(sapply(AF1,logLik))
bind_rows(AF1_lliks) %>%
remove_rownames(.) %>%
mutate(model = c("NB Mixed Effects Model")) %>%
select(model, everything()) %>%
group_by(model) %>%
gather(., Optimizer, llik, 2:ncol(.)) %>%
ggplot(.,aes(Optimizer, llik)) + geom_point() +
facet_wrap(~model) + coord_flip() +
ylab("Log-Likelihood") +
labs(title = "The Log-Likelihoods of Seven Different Optimizers in Our Model")
simulateResiduals(lm1, plot = T)
car::Anova(lm1, type = "III")
summary(lm1)
means <- cld(emmeans(lm1, pairwise ~ dpi, adjust = "tukey", type = "response"))
ggplot(means, aes(x = dpi, y = rate))+
geom_jitter(data = ti.mg, aes(x = dpi, y = tes, color = temp),
width = 0.1, alpha = 0.5)+
geom_line(aes(group = 1), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
ggplot(means, aes(x = dpi, y = rate, color = temp))+
geom_jitter(data = ti.mg, aes(x = dpi, y = tes),
width = 0.1, alpha = 0.5)+
geom_line(aes(group = temp), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
means <- cld(emmeans(lm1, pairwise ~ dpi*temp, adjust = "tukey", type = "response"))
ggplot(means, aes(x = dpi, y = rate, color = temp))+
geom_jitter(data = ti.mg, aes(x = dpi, y = tes),
width = 0.1, alpha = 0.5)+
geom_line(aes(group = temp), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
ggplot(means, aes(x = dpi, y = rate, color = temp))+
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL),
width = 0.1)+
geom_line(aes(group = temp), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()+
facet_wrap(~temp)
ggplot(means, aes(x = dpi, y = rate)+
ggplot(means, aes(x = dpi, y = rate))+
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL),
width = 0.1)+
geom_line(aes(group = temp), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
ggplot(means, aes(x = dpi, y = rate))+
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL),
width = 0.1)+
geom_line(aes(group = 1), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
means2 <- cld(emmeans(lm1, pairwise ~ dpi, adjust = "tukey", type = "response"))
ggplot(means2, aes(x = dpi, y = rate))+
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL),
width = 0.1)+
geom_line(aes(group = 1), linewidth = 1.2)+
geom_point(size = 3)+
theme_bw()
