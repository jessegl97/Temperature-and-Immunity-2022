m9id <- glmmTMB(fever_score ~ ever_diseased * dpi.f + temp * sex + (1|band_number), data = ti.f.i)
m_nulli <- glmmTMB(fever_score ~ 1 + (1|band_number), data = ti.f.i)
aictab(list(m1id, m2id, m3id, m4id, m4ids, m5id, m6id, m7id, m8id, m_nulli),
modnames = c("m1","m2","m3","m4", "m4ids", "m5", "m6", "m7", "m8", "null"))
ti.f.i <- ti.f %>%
filter(treatment == "Inoculated")
simulateResiduals(m7id, plot=T)
summary(m7id)
#Model selection
m1id <- glmmTMB(fever_score ~ temp * sex + dpi.f + ever_diseased + (1|band_number), data = ti.f.i)
m2id <- glmmTMB(fever_score ~ sex * ever_diseased * dpi.f + temp + (1|band_number), data = ti.f.i)
m3id <- glmmTMB(fever_score ~ sex * ever_diseased + dpi.f + temp + (1|band_number), data = ti.f.i)
m4id <- glmmTMB(fever_score ~ sex + ever_diseased * dpi.f + temp + (1|band_number), data = ti.f.i)
m4ids <- glmmTMB(fever_score ~ sex * ever_diseased * dpi.f + temp + (1|band_number), data = ti.f.i)
m5id <- glmmTMB(fever_score ~ sex + ever_diseased * dpi.f * temp + (1|band_number), data = ti.f.i)
m6id <- glmmTMB(fever_score ~ dpi.f * temp * sex * ever_diseased + (1|band_number), data = ti.f.i)
m7id <- glmmTMB(fever_score ~ ever_diseased * dpi.f + temp * sex + (1|band_number), data = ti.f.i)
m8id <- glmmTMB(fever_score ~ (sex + ever_diseased) * dpi.f + temp + (1|band_number), data = ti.f.i)
#sex interacts with temp, but does it interact with diseased?
m9id <- glmmTMB(fever_score ~ ever_diseased * dpi.f + temp * sex + (1|band_number), data = ti.f.i)
m_nulli <- glmmTMB(fever_score ~ 1 + (1|band_number), data = ti.f.i)
aictab(list(m1id, m2id, m3id, m4id, m4ids, m5id, m6id, m7id, m8id, m_nulli),
modnames = c("m1","m2","m3","m4", "m4ids", "m5", "m6", "m7", "m8", "null"))
simulateResiduals(m4id, plot=T)
summary(m4id)
car::Anova(glm_fever.id, type = "III")
glm_fever.id <- glmmTMB(fever_score ~ sex + ever_diseased * dpi.f + temp + (1|band_number), data = ti.f.i)
simulateResiduals(glm_fever.id, plot=T)
summary(glm_fever.id)
car::Anova(glm_fever.id, type = "III")
#Are control males warmer than control females?
glm_fever.cont <- glmmTMB(fever_score ~ temp * dpi.f + sex + (1|band_number), data=ti.f %>% filter(treatment == "Control"))
simulateResiduals(glm_fever.cont, plot=T)
summary(glm_fever.cont)
car::Anova(glm_fever.cont)
# Get emmeans (predicted marginal means)
emm_df <-  emmeans(glm_fever.cont, ~ sex * dpi.f * temp, type = "response") %>%
as.data.frame() %>%
left_join(
ti.f %>%
distinct(temp, dpi.f, sex, groups),
by = c("temp", "dpi.f", "sex")
)
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control"),
aes(x = dpi.f, y = fever_score, color = temp),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = temp),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = treatment, groups = temp),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = temp),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=temp),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = temp_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
# Get emmeans (predicted marginal means)
emm_df <-  emmeans(glm_fever.cont, ~ sex * dpi.f * temp, type = "response") %>%
as.data.frame() %>%
left_join(
ti.f %>%
distinct(temp, dpi.f, sex, groups),
by = c("temp", "dpi.f", "sex")
)
emm_df
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control"),
aes(x = dpi.f, y = fever_score, color = temp),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = temp),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = temp),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = temp),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=temp),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = temp_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
# Get emmeans (predicted marginal means)
emm_df <-  emmeans(glm_fever.cont, ~ sex * dpi.f * temp, type = "response") %>%
as.data.frame() %>%
left_join(
ti.f %>%
distinct(temp, dpi.f, sex, groups),
by = c("temp", "dpi.f", "sex")
)
emm_df <- emm_df %>%
mutate(sex = dplyr::recode(sex,
"M" = "Male",
"F" = "Female"))
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control"),
aes(x = dpi.f, y = fever_score, color = temp),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = temp),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = temp),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = temp),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=temp),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = temp_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
#Are control males warmer than control females?
glm_fever.cont <- glmmTMB(fever_score ~ temp * dpi.f + sex + (1|band_number),
data=ti.f %>% filter(treatment == "Control" & dpi.f != 18))
simulateResiduals(glm_fever.cont, plot=T)
summary(glm_fever.cont)
car::Anova(glm_fever.cont)
# Get emmeans (predicted marginal means)
emm_df <-  emmeans(glm_fever.cont, ~ sex * dpi.f * temp, type = "response") %>%
as.data.frame() %>%
left_join(
ti.f %>%
distinct(temp, dpi.f, sex, groups),
by = c("temp", "dpi.f", "sex")
)
emm_df <- emm_df %>%
mutate(sex = dplyr::recode(sex,
"M" = "Male",
"F" = "Female"))
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control"),
aes(x = dpi.f, y = fever_score, color = temp),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = temp),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = temp),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = temp),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=temp),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = temp_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control" & dpi.f != 18),
aes(x = dpi.f, y = fever_score, color = temp),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = temp),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = temp),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = temp),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=temp),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = temp_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
#did temperature differ between sexes between the rooms at baseline?
#model selection: Does sex predict body temperature when controlling for room temperature?
ti.f.cont <- ti.f %>%
filter(treatment == "Control")
c1 <- glmmTMB(fever_score ~ temp + sex + dpi.f + (1|band_number), data=ti.f.cont)
c2 <- glmmTMB(fever_score ~ temp + sex * dpi.f + (1|band_number), data=ti.f.cont)
c3 <- glmmTMB(fever_score ~ temp * sex + dpi.f + (1|band_number), data=ti.f.cont)
c4 <- glmmTMB(fever_score ~ temp * sex * dpi.f + (1|band_number), data=ti.f.cont)
c5 <- glmmTMB(fever_score ~ temp + dpi.f + (1|band_number), data=ti.f.cont)
c6 <- glmmTMB(fever_score ~ sex + dpi.f + (1|band_number), data=ti.f.cont)
null_fc <- glmmTMB(fever_score ~ 1 + (1|band_number), data=ti.f.cont)
aictab(list(c1, c2, c3, c4, c5, c6, null_fc),
modnames = c("c1","c2","c3","c4","c5","c6","null"))
#So it isn't a sex effect without stimulation
summary(c1)
car::Anova(lm.ts, type="III")
summary(lm.ts)
#DPI 18 maybe is an issue - uncomment and re-run to see exclusion analysis
ti.f <- ti.f %>%
filter(dpi.f != 18)
#I want to know whether treatment or temperature affect fever_score or shape of fever response
#while accounting for sex
m0 <- glmmTMB(fever_score ~ temp + treatment + sex + dpi.f + (1|band_number), data = ti.f)
m0.5 <- glmmTMB(fever_score ~ treatment + temp * sex + dpi.f + (1|band_number), data = ti.f)
m1 <- glmmTMB(fever_score ~ temp * treatment + sex + dpi.f + (1|band_number), data = ti.f)
m2 <- glmmTMB(fever_score ~ temp * dpi.f + treatment + sex + (1|band_number), data = ti.f)
m3 <- glmmTMB(fever_score ~ treatment * dpi.f + temp + sex + (1|band_number), data = ti.f)
m4 <- glmmTMB(fever_score ~ temp * treatment * dpi.f + sex + (1|band_number), data = ti.f)
m5 <- glmmTMB(fever_score ~ temp * treatment * dpi.f * sex + (1|band_number), data = ti.f)
m6 <- glmmTMB(fever_score ~ (treatment + temp) * dpi.f + sex + (1|band_number), data = ti.f)
m6s <- glmmTMB(fever_score ~ (treatment + temp) * dpi.f * sex + (1|band_number), data = ti.f)
m7 <- glmmTMB(fever_score ~ (treatment + temp + sex) * dpi.f + (1|band_number), data = ti.f)
m_null <- glmmTMB(fever_score ~ 1 + (1|band_number), data = ti.f)
aictab(list(m0, m0.5, m1, m2, m3, m4, m5, m6, m6s, m7, m_null),
modnames = c("m0","m0.5","m1","m2","m3","m4","m5","m6","m6s", "m7", "null"))
simulateResiduals(m6, plot=T)
hist(resid(m6))
summary(m6)
car::Anova(m6, type="III")
#Interaction between temp and dpi does not have one significant dpi, but overall interaction is significant
m_full  <- glmmTMB(fever_score ~ (treatment + temp) * dpi.f + sex + (1|band_number), data=ti.f)
m_drop  <- glmmTMB(fever_score ~ treatment * dpi.f + temp + dpi.f + sex + (1|band_number), data=ti.f)
#m_full has lower AIC = do not drop the interaction
AIC(m_full, m_drop)
glm_fever <- glmmTMB(fever_score ~ (treatment + temp) * dpi.f + sex + (1|band_number), data=ti.f)
simulateResiduals(glm_fever, plot=T)
#Residuals deviate a little - how is residual distribution?
hist(resid(glm_fever))
summary(glm_fever)
car::Anova(glm_fever, type = "III")
car::Anova(glm_fever, type = "II")
plot(allEffects(glm_fever))
# Get emmeans (predicted marginal means)
emm_df <-  emmeans(glm_fever, ~ sex * treatment * dpi.f * temp, type = "response") %>%
as.data.frame() %>%
left_join(
ti.f %>%
distinct(temp, treatment, dpi.f, sex, groups),
by = c("temp", "treatment", "dpi.f", "sex")
) %>%
dplyr::mutate(groups = dplyr::recode(groups,
"Warm Control" = "Warm Control",
"Cold Control" = "Cold Control",
"Cold Infected" = "Cold Inoculated",
"Warm Infected" = "Warm Inoculated"))
emm_df <- emm_df %>%
mutate(sex = dplyr::recode(sex,
"M" = "Male",
"F" = "Female"))
ti.f.g <- ti.f %>%
dplyr::mutate(groups = dplyr::recode(groups,
"Cold Infected" = "Cold Inoculated",
"Warm Infected" = "Warm Inoculated"))
ti.f.g <- ti.f.g %>%
dplyr::mutate(sex = dplyr::recode(sex,
"M" = "Male",
"F" = "Female"))
dodge <- position_dodge(width = .5)
#Model predictions by temp
ggplot() +
geom_point(data = ti.f.g,
aes(x = dpi.f, y = fever_score, color = groups),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = groups),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = treatment, groups = groups),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = groups),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=groups),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = treat_colors) +
#scale_fill_manual(values=treat_colors)+
scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
scale_linetype_manual(
name   = "Inoculation Type",
values = c("dashed", "solid"),
labels = c("Control", "Inoculated")
)+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
#Are control males warmer than control females?
glm_fever.cont <- glmmTMB(fever_score ~ temp * dpi.f + sex + (1|band_number),
data=ti.f %>% filter(treatment == "Control" & dpi.f != 18))
simulateResiduals(glm_fever.cont, plot=T)
#Are control males warmer than control females?
glm_fever.cont <- glmmTMB(fever_score ~ temp * dpi.f + sex + (1|band_number),
data=ti.f %>% filter(treatment == "Control"))
simulateResiduals(glm_fever.cont, plot=T)
summary(glm_fever.cont)
car::Anova(glm_fever.cont)
# Get emmeans (predicted marginal means)
emm_df <-  emmeans(glm_fever.cont, ~ sex * dpi.f * temp, type = "response") %>%
as.data.frame() %>%
left_join(
ti.f %>%
distinct(temp, dpi.f, sex, groups),
by = c("temp", "dpi.f", "sex")
)
emm_df <- emm_df %>%
mutate(sex = dplyr::recode(sex,
"M" = "Male",
"F" = "Female"))
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control" & dpi.f != 18),
aes(x = dpi.f, y = fever_score, color = temp),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = temp),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = temp),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = temp),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=temp),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = temp_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~sex)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
scale_color_manual(values = sex_colors) +
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control" & dpi.f != 18),
aes(x = dpi.f, y = fever_score, color = sex),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = sex),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = sex),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = sex),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=sex),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = sex_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~temp)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
ggplot() +
geom_point(data = ti.f.g %>% filter(treatment == "Control" & dpi.f != 18),
aes(x = dpi.f, y = fever_score, color = sex),
position =dodge,
alpha = 0.5, size = 2) +
geom_errorbar(data = emm_df,
aes(x = dpi.f, ymin = lower.CL, ymax = upper.CL, groups = sex),
color="black", position = dodge, width = 0.1) +
# geom_ribbon(data = emm_df,
#               aes(x = as.numeric(dpi.f), ymin = lower.CL, ymax = upper.CL, groups = groups, fill=groups),
#               position = dodge, alpha=0.2) +
#
geom_line(data = emm_df,
aes(x = as.numeric(dpi.f), y = emmean, linetype = temp, groups = sex),
color="black", position = dodge, size =0.25) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, color = sex),
position = dodge, size = 2.8) +
geom_point(data = emm_df,
aes(x = dpi.f, y = emmean, group=sex),
position = dodge, size = 2.8,
shape=1, color="black") +
# stat_summary(data = ti.f.g, aes(x=dpi.f, y= fever_score, group = interaction(treatment, temp), color=groups), geom="line", fun = "mean")+
scale_color_manual(values = sex_colors) +
#scale_fill_manual(values=treat_colors)+
#scale_shape_manual(values = c(1, 1, 1, 1))+
labs(x = "Days Post Inoculation", y = "Ocular Temperature (C)", color = "Treatment Group", shape="Treatment Group", linetype="Inoculation Type") +
# scale_linetype_manual(
#   name   = "Inoculation Type",
#   values = c("dashed", "solid"),
#   labels = c("Control", "Inoculated")
# )+
facet_grid(~temp)+ #, scales = "free_y"
theme(strip.text = element_text(size=12))
ti.f.i <- ti.f %>%
filter(treatment == "Inoculated")
#Model selection
m0i <- glmmTMB(fever_score ~ temp + sex + dpi.f + (1|band_number), data = ti.f.i)
m0.5i <- glmmTMB(fever_score ~ temp + sex * dpi.f + (1|band_number), data = ti.f.i)
m1i <- glmmTMB(fever_score ~ temp * sex + dpi.f + (1|band_number), data = ti.f.i)
m2i <- glmmTMB(fever_score ~ sex * dpi.f + temp + (1|band_number), data = ti.f.i)
m3i <- glmmTMB(fever_score ~ temp * dpi.f + sex + (1|band_number), data = ti.f.i)
m4i <- glmmTMB(fever_score ~ dpi.f * temp * sex + (1|band_number), data = ti.f.i)
m_nulli <- glmmTMB(fever_score ~ 1 + (1|band_number), data = ti.f.i)
aictab(list(m0i, m0.5i, m1i, m2i, m3i, m4i, m_nulli),
modnames = c("m0", "m0.5i", "m1","m2","m3","m4", "null"))
simulateResiduals(m1i, plot=T)
glm_fever.i <- glmmTMB(fever_score ~ temp * sex + dpi.f + (1|band_number), data = ti.f.i %>% filter(ever_diseased == 1))
simulateResiduals(glm_fever.i, plot=T)
summary(glm_fever.i)
car::Anova(glm_fever.i, type = "III")
summary(glm_fever.i)
glm_fever.i <- glmmTMB(fever_score ~ temp * sex + dpi.f + (1|band_number), data = ti.f.i))
glm_fever.i <- glmmTMB(fever_score ~ temp * sex + dpi.f + (1|band_number), data = ti.f.i)
simulateResiduals(glm_fever.i, plot=T)
summary(glm_fever.i)
